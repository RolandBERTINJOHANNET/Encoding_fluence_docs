Search.setIndex({"docnames": ["index", "model", "util"], "filenames": ["index.rst", "model.rst", "util.rst"], "titles": ["Welcome to Vae_Train_and_Extract\u2019s documentation!", "Model Functionalities", "Metrics and Utilities"], "terms": {"packag": [0, 1], "provid": [0, 1, 2], "comprehens": 0, "suit": 0, "tool": 0, "train": 0, "deep": 0, "learn": [0, 1], "model": [0, 2], "specif": [0, 1], "variat": [0, 1], "autoencod": [0, 1], "vae": [0, 1], "extract": [0, 1, 2], "metric": 0, "from": [0, 1, 2], "them": [0, 1], "The": [0, 1, 2], "design": [0, 1], "focu": 0, "fluenc": 0, "measur": 0, "eas": 0, "inform": 0, "process": [0, 1], "brain": 0, "includ": [0, 1], "function": [0, 2], "develop": 0, "align": 0, "our": [0, 1], "need": [0, 1], "explor": 0, "differ": [0, 1], "wai": [0, 1], "bypass": 0, "decod": [0, 1], "ad": [0, 1], "sparsiti": [0, 1], "constraint": [0, 1], "make": 0, "more": [0, 1], "biolog": 0, "realist": 0, "It": [0, 1, 2], "also": [0, 1], "mechan": [0, 1], "attent": [0, 1, 2], "how": 0, "we": 0, "pai": 0, "an": [0, 1, 2], "imag": [0, 1, 2], "can": [0, 1, 2], "whether": [0, 1], "find": 0, "beauti": 0, "final": 0, "goal": 0, "thi": [0, 1, 2], "gather": 0, "work": [0, 1], "carri": 0, "out": 0, "dure": [0, 2], "project": [0, 1], "user": [0, 2], "friendli": 0, "code": [0, 2], "interfac": 0, "complet": 0, "potenti": 0, "explanatori": 0, "video": 0, "core": 0, "basic_modul": 0, "attention_modul": 0, "util": 0, "data": [0, 1], "plot": 0, "index": [0, 1], "modul": [0, 2], "search": 0, "page": 0, "section": [1, 2], "detail": [1, 2], "overview": [1, 2], "variou": [1, 2], "within": [1, 2], "each": [1, 2], "contain": [1, 2], "set": [1, 2], "ar": [1, 2], "integr": 1, "oper": 1, "defin": 1, "uniqu": 1, "architectur": 1, "allow": 1, "imposit": 1, "certain": 1, "layer": [1, 2], "which": [1, 2], "compact": 1, "interpret": 1, "represent": 1, "compos": 1, "encod": 1, "vgg19": 1, "pixel": 1, "shuffl": 1, "gradual": 1, "upscal": 1, "featur": 1, "map": 1, "back": 1, "origin": [1, 2], "size": 1, "method": 1, "access": 1, "activ": [1, 2], "ani": [1, 2], "exampl": [1, 2], "usag": [1, 2], "model_nam": [1, 2], "cuda": [1, 2], "1": 1, "2": 1, "3": 1, "0": [1, 2], "001": 1, "x": 1, "torch": [1, 2], "randn": 1, "224": 1, "output": [1, 2], "kl": [1, 2], "att": 1, "devic": [1, 2], "layer_sparsity_cstraint": 1, "sparsity_coeff": 1, "sparsity_param": 1, "A": [1, 2], "paramet": [1, 2], "str": [1, 2], "name": [1, 2], "run": 1, "cpu": 1, "list": [1, 2], "option": [1, 2], "indic": 1, "appli": 1, "valu": 1, "float": 1, "coeffici": 1, "__annotations__": 1, "__init__": [1, 2], "initi": [1, 2], "intern": 1, "state": [1, 2], "share": 1, "both": 1, "nn": [1, 2], "scriptmodul": 1, "__module__": [1, 2], "build_decod": [], "build_encod": [], "input": [1, 2], "latent": 1, "space": 1, "tensor": 1, "return": [1, 2], "type": 1, "sampl": 1, "fals": [1, 2], "bool": 1, "forward": 1, "pass": 1, "through": 1, "tupl": [1, 2], "diverg": [1, 2], "get_activ": 1, "layer_nam": 1, "pixelshuffl": 1, "upscale_factor": 1, "perform": [1, 2], "without": 1, "introduc": 1, "new": 1, "factor": 1, "determin": 1, "spatial": 1, "dimens": 1, "increas": 1, "int": [1, 2], "comput": 1, "everi": 1, "call": [1, 2], "should": [1, 2], "overridden": 1, "all": [1, 2], "subclass": 1, "although": 1, "recip": 1, "one": 1, "instanc": [1, 2], "afterward": 1, "instead": 1, "sinc": 1, "former": 1, "take": [1, 2], "care": 1, "regist": 1, "hook": 1, "while": 1, "latter": 1, "silent": 1, "ignor": 1, "basic": 1, "block": 1, "neural": 1, "network": 1, "pretrain": 1, "adapt": [1, 2], "other": 1, "well": 1, "noconstraint": 1, "relu": 1, "its": 1, "built": 1, "convblock": 1, "meanstdfeaturemap": 1, "reparametr": 1, "have": [1, 2], "add_constraint": 1, "switch": 1, "sparsityconstraint": 1, "sigmoid": 1, "between": 1, "mean": 1, "constant": 1, "distribut": 1, "encourag": 1, "resblock": 1, "standard": 1, "residu": 1, "consist": 1, "two": 1, "convolut": 1, "batch": [1, 2], "normal": 1, "leakyrelu": 1, "follow": 1, "addit": 1, "add": 1, "wrap": 1, "vgg19_featur": 1, "non": 1, "extractor": 1, "organ": 1, "where": [1, 2], "you": 1, "anywher": 1, "gener": 1, "featuremap": 1, "std": 1, "must": 1, "re": 1, "parametr": 1, "gaussian": 1, "sig": 1, "mu": 1, "right": 1, "befor": 1, "conv2d": 1, "idx": 1, "pytorch": [1, 2], "conv": 1, "replac": 1, "result": 1, "constraint_param": 1, "scaling_param": 1, "none": [1, 2], "current": [1, 2], "gradient": 1, "in_channel": 1, "latent_dim": 1, "deviat": 1, "conv_mean": 1, "conv_std": 1, "mean_or_std": 1, "appropri": 1, "placehold": 1, "when": 1, "desir": [1, 2], "along": 1, "nb_chan": 1, "sequenti": 1, "sequenc": 1, "calcul": [1, 2], "scale": 1, "constraint_loc": 1, "feature_extractor": 1, "attention_lay": 1, "constrained_cbam": 1, "all_lay": 1, "total": 1, "loss": [1, 2], "up": 1, "specifi": [1, 2], "__len__": 1, "number": [1, 2], "add_attention_lay": 1, "build_conv": 1, "build_feature_extractor": 1, "basicconv": 1, "in_plan": 1, "out_plan": 1, "kernel_s": 1, "stride": 1, "pad": 1, "dilat": 1, "group": 1, "true": 1, "bn": 1, "bia": 1, "cbam_sparsityconstraint": [], "channelg": 1, "gate_channel": 1, "reduction_ratio": 1, "16": 1, "pool_typ": 1, "avg": 1, "max": 1, "get_att_map": 1, "channelpool": 1, "no_spati": 1, "flatten": 1, "logsumexp_2d": 1, "folder": 2, "relat": 2, "handl": 2, "preprocess": 2, "class": 2, "optionalsplitdataset": 2, "root_dir": 2, "split": 2, "custom": [], "dataset": 2, "load": 2, "us": 2, "creat": [], "object": 2, "dataload": 2, "effici": [], "attribut": [1, 2], "onto": [], "file_path": 2, "path": 2, "file": 2, "warn": [], "flag": [], "issu": [], "224x224": [], "arg": 2, "root": [], "directori": 2, "keep": [], "80": [], "test": [], "20": [], "100": 2, "train_dataset": [], "gpu": [], "test_dataset": [], "4": [], "get": 1, "num_imag": 2, "len": [], "5": [1, 2], "full_dataset": [], "__getitem__": [], "label": [], "constructor": [], "__parameters__": [], "get_all_image_path": [], "recurs": [], "static": [], "process_imag": [], "image_path": [], "read": [], "check": [], "resiz": [], "move": [], "metricextractor": 2, "given": 2, "sever": [], "primarili": [], "dictionari": [], "These": [], "wise": 1, "l1": 1, "norm": 1, "gini": [], "kurtosi": [], "reconstruct": 2, "error": [], "base": [], "stochast": [], "weight": [], "averag": [], "swag": [], "delta": [], "loss_funct": [], "dict": 2, "import": [1, 2], "my_model": 2, "metric_extractor": 2, "path_to_imag": [], "jpg": [], "__call__": [], "__dict__": [], "mappingproxi": [], "__doc__": [], "n": [], "python": [], "calculate_metr": [], "calculate_gini": [], "get_reco_error": [], "get_sam_delta": [], "__weakref__": [], "weak": [], "refer": [], "loss_nam": [], "visual": 2, "histogram": 2, "plot_activation_histogram": 2, "save": 2, "properli": 2, "iter": 2, "valid": 2, "ha": 2, "write": 2, "permiss": 2, "default": [1, 2], "posit": 2, "integ": 2, "rais": 2, "valueerror": 2, "If": 2, "expect": 2, "imagefold": 2, "path_to_dataset": 2, "path_to_save_plot": 2, "10": 2, "plot_innout": 2, "epoch": 2, "side": 2, "loader": 2, "purpos": 2, "torchvis": 2, "transform": 2, "totensor": 2, "batch_siz": 2, "64": [1, 2], "main": 2, "sam": 2, "param": 2, "base_optim": 2, "rho": 2, "05": 2, "kwarg": 2, "first_step": 2, "zero_grad": 2, "load_state_dict": 2, "state_dict": 2, "optim": 2, "second_step": 2, "step": 2, "closur": 2, "singl": 2, "updat": 2, "callabl": 2, "reevalu": 2, "most": 2, "unless": 2, "otherwis": 2, "modifi": [1, 2], "grad": 2, "field": 2, "train_the_model": 2, "opt": 2, "nb_epoch": 2, "frequenc": 2, "three": 2, "per": 2, "empti": 2, "mseloss": 2, "adam": 2, "reconstruction_loss_per_batch": 2, "kl_divergence_per_batch": 2, "attention_per_batch": 2, "taken": [1, 2], "git": [1, 2], "implement": [1, 2], "channel": 1, "gate": 1, "pool": 1, "concaten": 1, "version": 1, "cbam": 1, "onli": 1, "depth": 1, "known": 1, "ratio": 1, "reduct": 1, "exclud": 1, "simpl": 1, "log": 1, "sum": 1, "exp": 1, "2d": 1, "kei": [], "s": [], "depend": [], "For": [], "absolut": [], "sharp": 2, "awar": 2, "minim": 2, "inspir": [], "much": [], "small": [], "chang": [], "collaps": [], "abil": []}, "objects": {"core.model": [[1, 0, 0, "-", "attention_modules"], [1, 0, 0, "-", "basic_modules"], [1, 0, 0, "-", "model"]], "core.model.attention_modules": [[1, 1, 1, "", "BasicConv"], [1, 1, 1, "", "ChannelGate"], [1, 1, 1, "", "ChannelPool"], [1, 1, 1, "", "Constrained_CBAM"], [1, 1, 1, "", "Flatten"], [1, 4, 1, "", "logsumexp_2d"]], "core.model.attention_modules.BasicConv": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.attention_modules.ChannelGate": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_att_map"]], "core.model.attention_modules.ChannelPool": [[1, 2, 1, "", "__annotations__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.attention_modules.Constrained_CBAM": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.attention_modules.Flatten": [[1, 2, 1, "", "__annotations__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.basic_modules": [[1, 1, 1, "", "ConvBlock"], [1, 1, 1, "", "MeanStdFeatureMaps"], [1, 1, 1, "", "NoConstraint"], [1, 1, 1, "", "Reparametrization"], [1, 1, 1, "", "ResBlock"], [1, 1, 1, "", "SparsityConstraint"], [1, 1, 1, "", "VGG19_Features"]], "core.model.basic_modules.ConvBlock": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "add_constraint"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.basic_modules.MeanStdFeatureMaps": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "add_constraint"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.basic_modules.NoConstraint": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.basic_modules.Reparametrization": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "add_constraint"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.basic_modules.ResBlock": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.basic_modules.SparsityConstraint": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "forward"]], "core.model.basic_modules.VGG19_Features": [[1, 2, 1, "", "__annotations__"], [1, 3, 1, "", "__init__"], [1, 3, 1, "", "__len__"], [1, 2, 1, "", "__module__"], [1, 3, 1, "", "add_attention_layers"], [1, 3, 1, "", "build_convs"], [1, 3, 1, "", "build_feature_extractor"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.model": [[1, 1, 1, "", "Model"], [1, 1, 1, "", "PixelShuffler"]], "core.model.model.Model": [[1, 3, 1, "", "decode"], [1, 3, 1, "", "encode"], [1, 3, 1, "", "forward"], [1, 3, 1, "", "get_activations"]], "core.model.model.PixelShuffler": [[1, 3, 1, "", "forward"]], "core": [[2, 0, 0, "-", "plotting"], [2, 0, 0, "-", "training"]], "core.plotting": [[2, 4, 1, "", "plot_activation_histograms"], [2, 4, 1, "", "plot_inNout"]], "core.training": [[2, 1, 1, "", "SAM"], [2, 4, 1, "", "train_the_model"]], "core.training.SAM": [[2, 3, 1, "", "__init__"], [2, 2, 1, "", "__module__"], [2, 3, 1, "", "first_step"], [2, 3, 1, "", "load_state_dict"], [2, 3, 1, "", "second_step"], [2, 3, 1, "", "step"]]}, "objtypes": {"0": "py:module", "1": "py:class", "2": "py:attribute", "3": "py:method", "4": "py:function"}, "objnames": {"0": ["py", "module", "Python module"], "1": ["py", "class", "Python class"], "2": ["py", "attribute", "Python attribute"], "3": ["py", "method", "Python method"], "4": ["py", "function", "Python function"]}, "titleterms": {"welcom": 0, "vae_train_and_extract": 0, "s": 0, "document": 0, "content": 0, "indic": 0, "tabl": 0, "model": 1, "function": 1, "core": [1, 2], "basic_modul": 1, "modul": 1, "us": 1, "build": 1, "main": 1, "class": 1, "attention_modul": 1, "metric": 2, "util": 2, "data": 2, "plot": 2, "train": 2}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx": 56}})